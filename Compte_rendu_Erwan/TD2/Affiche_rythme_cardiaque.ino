#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_GC9A01.h>

#define SCREEN_WIDTH 240
#define SCREEN_HEIGHT 240

Adafruit_GC9A01 tft = Adafruit_GC9A01(SCREEN_WIDTH, SCREEN_HEIGHT);

int heartRate = 75; // Remplacez ceci par la lecture réelle du rythme cardiaque

void setup() {
  Serial.begin(115200);

  if (!tft.begin()) {
    Serial.println("Impossible d'initialiser l'écran GC9A01. Vérifiez les connexions!");
    while (1);
  }

  tft.fillScreen(GC9A01_BLACK);
  tft.setRotation(1);  // Vous pouvez ajuster la rotation en fonction de l'orientation de votre écran

  // Affichage initial du rythme cardiaque
  afficherRythmeCardiaque();
}

void loop() {
  // Lisez le rythme cardiaque réel depuis le capteur ici
  // heartRate = lireRythmeCardiaque();

  // Affichez le rythme cardiaque sur l'écran
  afficherRythmeCardiaque();

  delay(1000); // Rafraîchissez l'affichage toutes les secondes
}

void afficherRythmeCardiaque() {
  tft.fillScreen(GC9A01_BLACK);

  // Affichez le cœur
  tft.drawBitmap(80, 80, coeurBitmap, 80, 80, GC9A01_WHITE);

  // Affichez le rythme cardiaque
  tft.setTextSize(3);
  tft.setCursor(40, 200);
  tft.setTextColor(GC9A01_WHITE);
  tft.print("BPM: " + String(heartRate));
}

// Le bitmap d'un cœur (remplacez-le par votre propre image si nécessaire)
static const unsigned char coeurBitmap[] = {
  0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x7F, 0x80, 0x00, 0x00, 0xFF, 0xC0, 0x00, 0x01, 0xFF, 0xE0,
  0x00, 0x03, 0xFF, 0xF0, 0x00, 0x07, 0xFF, 0xF8, 0x00, 0x0F, 0xFF, 0xFC, 0x00, 0x0F, 0xFF, 0xFC,
  0x00, 0x1F, 0xFF, 0xFE, 0x00, 0x1F, 0xFF, 0xFE, 0x00, 0x3F, 0xFF, 0xFF, 0x00, 0x3F, 0xFF, 0xFF,
  0x00, 0x3F, 0xFF, 0xFF, 0x00, 0x3F, 0xFF, 0xFF, 0x00, 0x3F, 0xFF, 0xFF, 0x00, 0x1F, 0xFF, 0xFE,
  0x00, 0x1F, 0xFF, 0xFE, 0x00, 0x0F, 0xFF, 0xFC, 0x00, 0x0F, 0xFF, 0xFC, 0x00, 0x07, 0xFF, 0xF8,
  0x00, 0x03, 0xFF, 0xF0, 0x00, 0x01, 0xFF, 0xE0, 0x00, 0x00, 0xFF, 0xC0, 0x00, 0x00, 0x7F, 0x80,
  0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x00
};
